{
  "version": 4,
  "terraform_version": "1.10.5",
  "serial": 10,
  "lineage": "5877211b-14ca-4cbb-b040-f8e74ef27748",
  "outputs": {
    "usage_example": {
      "value": "# Apply this configuration with:\nterraform apply -var=\"infrastructure_code=resource \"aws_instance\" \"web\" {\n  ami           = \"ami-12345678\"\n  instance_type = \"t3.micro\"\n\n  root_block_device {\n    encrypted = false\n  }\n\n  vpc_security_group_ids = [\"sg-12345678\"]\n\n  tags = {\n    Environment = \"Production\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"data\" {\n  bucket = \"my-important-data\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"data\" {\n  bucket = aws_s3_bucket.data.id\n      \n  block_public_acls       = false\n  block_public_policy     = false\n  ignore_public_acls      = false\n  restrict_public_buckets = false\n}\n\"\n\n# The assistant will analyze the code and provide:\n# 1. Security issues (e.g., unencrypted EBS, public S3 bucket)\n# 2. Compliance violations (e.g., CIS AWS Foundations)\n# 3. Remediation steps\n",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "managed",
      "type": "openai_file",
      "name": "aws_guidelines",
      "provider": "provider[\"registry.terraform.io/happypathway/openai\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "bytes": 672,
            "content": null,
            "created_at": 1741412374,
            "file_path": "./aws-security-best-practices.md",
            "filename": "aws-security-best-practices.md",
            "id": "file-ARJ2LFf3twznnraiNMo9Fc",
            "object_id": "file-ARJ2LFf3twznnraiNMo9Fc",
            "purpose": "assistants",
            "status": "processed",
            "status_details": ""
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "content"
              }
            ]
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "openai_file",
      "name": "compliance_standards",
      "provider": "provider[\"registry.terraform.io/happypathway/openai\"]",
      "instances": [
        {
          "status": "tainted",
          "schema_version": 0,
          "attributes": {
            "bytes": 596,
            "content": "{\"standards\":{\"cis\":{\"controls\":[{\"description\":\"Ensure contact email and phone are current for security notifications\",\"id\":\"1.1\",\"title\":\"Maintain current contact details\"},{\"description\":\"Enable MFA for all human users in the AWS Account\",\"id\":\"1.2\",\"title\":\"Multi factor authentication\"}],\"version\":\"1.4.0\"},\"nist\":{\"framework\":\"CSF\",\"functions\":[\"Identify\",\"Protect\",\"Detect\",\"Respond\",\"Recover\"],\"version\":\"1.1\"},\"soc2\":{\"controls\":{\"CC1\":\"Control Environment\",\"CC2\":\"Communication and Information\",\"CC3\":\"Risk Assessment\"},\"principles\":[\"Security\",\"Availability\",\"Processing Integrity\"]}}}",
            "created_at": 1741412818,
            "file_path": null,
            "filename": "openai-312112412-compliance-standards.json",
            "id": "file-HDUhDGEV2Rb7aC2FU6XCA2",
            "object_id": "file-HDUhDGEV2Rb7aC2FU6XCA2",
            "purpose": "assistants",
            "status": "processed",
            "status_details": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "content"
              }
            ]
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "openai_file",
      "name": "security_policies",
      "provider": "provider[\"registry.terraform.io/happypathway/openai\"]",
      "instances": [
        {
          "status": "tainted",
          "schema_version": 0,
          "attributes": {
            "bytes": 432,
            "content": "{\"policies\":{\"authentication\":{\"description\":\"Strong authentication controls must be enabled\",\"mfa_required\":true,\"password_policy\":{\"min_length\":12,\"require_special_chars\":true}},\"encryption\":{\"algorithms\":[\"AES-256\",\"TLS-1.2\"],\"description\":\"All data must be encrypted at rest and in transit\",\"required\":true},\"network_access\":{\"description\":\"Resources must not be publicly accessible\",\"public_access\":false,\"vpn_required\":true}}}",
            "created_at": 1741412818,
            "file_path": null,
            "filename": "openai-1587838963-security-policies.json",
            "id": "file-E7hQrumEyXbgLoR7CZbJNa",
            "object_id": "file-E7hQrumEyXbgLoR7CZbJNa",
            "purpose": "assistants",
            "status": "processed",
            "status_details": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "content"
              }
            ]
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "openai_message",
      "name": "scan_request",
      "provider": "provider[\"registry.terraform.io/happypathway/openai\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "assistant_id": null,
            "content": "Please perform a comprehensive security and compliance analysis of the following infrastructure code:\n\n```hcl\nresource \"aws_instance\" \"web\" {\n  ami           = \"ami-12345678\"\n  instance_type = \"t3.micro\"\n\n  root_block_device {\n    encrypted = false\n  }\n\n  vpc_security_group_ids = [\"sg-12345678\"]\n\n  tags = {\n    Environment = \"Production\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"data\" {\n  bucket = \"my-important-data\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"data\" {\n  bucket = aws_s3_bucket.data.id\n      \n  block_public_acls       = false\n  block_public_policy     = false\n  ignore_public_acls      = false\n  restrict_public_buckets = false\n}\n\n```\n",
            "created_at": 1741412375,
            "file_ids": null,
            "id": "msg_UPzVWzkutTEBU45bU5SuU3sj",
            "metadata": null,
            "object": null,
            "role": "user",
            "run_id": null,
            "thread_id": "thread_7towSQKhWb2NaO2efmpYd54J"
          },
          "sensitive_attributes": [],
          "dependencies": [
            "openai_thread.security_scan"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "openai_thread",
      "name": "security_scan",
      "provider": "provider[\"registry.terraform.io/happypathway/openai\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "created_at": 1741412374,
            "id": "thread_7towSQKhWb2NaO2efmpYd54J",
            "messages": [],
            "metadata": {
              "environment": "production",
              "scan_level": "detailed",
              "scan_type": "security-and-compliance"
            },
            "object": "thread",
            "tool_resources": null,
            "tools": null
          },
          "sensitive_attributes": []
        }
      ]
    }
  ],
  "check_results": null
}
